<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <script type="text/javascript">
            function permission_cb(permission) {
                switch (permission) {
                    case "granted":
                        console.log("notification permission granted");
                        break;
                    case "denied":
                        console.log("[FAIL] notification permission denied");
                        break;
                    case "default":
                        console.log("[FAIL] notification permission aborted");
                        break;
                    default:
                        console.log("[FAIL] unknown value for permission: " + Notification.permission);
                        break;
                }
            }

            function get_notification_permission() {
                if (!("Notification" in window)) {
                    console.log("[FAIL] notifications unavailable");
                }
                if (Notification.permission === "default") {
                    Notification.requestPermission(permission_cb);
                }
            }

            function show_notification() {
                get_notification_permission();
                let notification = new Notification("notification title", {
                    body: "notification body"
                });
                notification.onclick = function() { console.log("notification clicked"); };
                notification.onclose = function() { console.log("notification closed"); };
                notification.onshow = function() { console.log("notification shown"); };
            }

            function show_symbol_notification() {
                get_notification_permission();
                let str = "<< && >>";
                let notification = new Notification(str, { body: str });
                notification.onshow = function() { console.log("notification shown"); };
            }

            function show_multiple_notifications() {
                get_notification_permission();
                for (let i = 1; i <= 3; i++) {
                    let notification = new Notification(`i=${i}`, { tag: 'counter' });
                    notification.onshow = function() { console.log(`i=${i} notification shown`); };
                }
            }

            function show_image_notification() {
                get_notification_permission();
                // For manual testing
                let notification = new Notification("qutebrowser logo", { icon: '/data/img/qutebrowser.png' });
            }

            function show_image_notification_noalpha() {
                get_notification_permission();
                // For manual testing
                let notification = new Notification("qutebrowser logo", { icon: '/data/img/qutebrowser-noalpha.png' });
            }
        </script>
    </head>
    <body>
        <div>
            <input type="button" onclick="get_notification_permission()" value="Get notification permission" id="button">
        </div>
        <div>
            <input type="button" onclick="show_notification()" value="Show notification" id="show-button">
            <input type="button" onclick="show_symbol_notification()" value="Show notification with symbols" id="show-symbols-button">
            <input type="button" onclick="show_multiple_notifications()" value="Show multiple notifications" id="show-multiple-button">
        </div>
        <div>
            <input type="button" onclick="show_image_notification()" value="Show image notification" id="show-image-button">
            <input type="button" onclick="show_image_notification_noalpha()" value="Show image notification without alpha channel" id="show-image-button-noalpha">
        </div>
    </body>
</html>
